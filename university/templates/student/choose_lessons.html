{% extends "student/base_s.html" %}
{% load i18n static %}
{% load university_mytags %}


{% block extrahead %}
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
{% endblock %}


{% block title %}Turmas{% endblock %}

{% block content_title %}Preencha o formulario:{% endblock %}

{% block breadcrumbs %}
        › Inscrição Turmas
{% endblock %}


{% block content %}

<div id="content-main">


		<div class="row">
			<div class="col-lg-12">
				<div class="panel panel-default">
					<div class="panel-heading">Incrições em turmas</div>
					<div class="panel-body">
						<div class="col-md-12">
              
							<form role="form" id="insert_disciplina">

                {{ subjs }}



                {% for subj, dicTypeTurmaLessons in subjs.items %}
                  <p>{{subj.name}}</p>
                  {% for tipo, turmasLessons in dicTypeTurmaLessons.items %}
                  <p>{{tipo}}</p>
                  {% for turmaLessons in turmasLessons %}
           
                  <button type="button" onclick="criarHorario('{{turmaLessons|last}}')" >{{turmaLessons|first}}</button>
                 
              
                  {% endfor %}

                  {% endfor %}
                  <br><br><br><br>
                {% endfor %}

                <br><br>
                
                <button id="submit" type="submit" style="float: right" class="btn btn-lg btn-primary" >Submit Button</button>
                <button type="reset" class="btn btn-default">Reset Button</button>
                <button type="reset" class="btn btn-default"><a href="{% url 'inscricoes_subject_s' %}">Voltar</a></button>
							</form>
						</div>
					</div>
        </div><!-- /.panel-->
        
        <table id="tabelaSchedule"></table>

			</div><!-- /.col-->
		</div><!-- /.row -->
</div>

<script>
  function criarHorario(detalhes){
    console.log(detalhes)
    var lstLessons= detalhes.split("|").slice(0, -1);
    var scheduleDict= {}
     

     //todas os botoes das lessons q foram "activados"

     //percorrer o valor desses botoes
     var lstlesson= []
     for (var i = 0; i < lstLessons.length; i++) {
      lstlesson.push(lstLessons[i].split(","))
    }
   

    //lstlesson[0][0]= "QUINTA";
    //lstlesson[0][1]= " 16:00";

    for (var i = 0; i<lstlesson.length; i++){
      if (lstlesson[i][0] in scheduleDict) {
        scheduleDict[lstlesson[i][0]].push([[lstlesson[i].slice(1, 6)]])
      }else{
        scheduleDict[lstlesson[i][0]]= [[lstlesson[i].slice(1, 6)]]
      }
    }


    // Importante: para o mesmo dia de semana, as aulas TEM QUE ESTAR POR ORDEM!! (by time) 
    for (var key in scheduleDict) {
      scheduleDict[key]= scheduleDict[key].sort(function(a,b){return (a[0] > b[0]) ? 1 : -1});
    }
    console.log(scheduleDict)

    buildSchedule(scheduleDict);
   
  }
</script>


{% endblock %}
	